<!DOCTYPE html>
<head>
	<meta http-equiv="Content-type" content="text/html; charset=utf-8"/>
	<title>index</title>
	<style type="text/css" media="screen">
		html {
			font-size: .9em;
		}

		.block {
			padding: 20px;
		}
		#status, #myDiv {
			text-align: left;
			vertical-align: middle;
			max-width: 60%;
			text-overflow: ellipsis;
			/* Required for text-overflow to do anything */
			overflow: hidden;
		}
		#status:hover {
			overflow: visible;
		}
		input[type=text] {
			width: 100%;
		}
	</style>
</head>
<body id="index" onload="">
	<div class="block">
		<div id="likeform">
			<label for="url">Script URL</label>
			<input type="text" name="url" value="https://script.google.com/macros/s/AKfycbwg1x0pf0q8hpUH1drF7xqN9zNyDHGMDxEI7nJM-pdvQoIuWDyY/exec?bukva=erer" id="url"/>
			<label for="id">ID of Sheet</label>
			<input type="text" name="id" value="19d948qIBG3CUwvMxRG90sJZf4rYBZwY4X2O3R9zSlEo" id="id"/>
			<label for="sh">Sheet name</label>
			<input type="text" name="sh" value="Sheet1" id="sh"/>
			<br>
			<input type="button" name="SEND" value="SEND" id="SEND" onclick="send()" />
		</div>
	</div>
	<div class="block">
		<span>STATUS</span>
		<div id="status"></div>
	</div>
	<div class="block">
		<span>RESPONCE</span>
		<div id="myDiv"></div>
	</div>
	<script type="text/javascript" charset="utf-8">
		(function(_go_) {
			function Sender(url, json, onreadystatechange, ready) {
				console.log('i\'m in ');
				this.url = url;
				this.params = (function(json) {
					var d = new FormData();
					for (var i in json) {
						d.append(i, json[i]);
					}
					return d;
				})(json);
				this.onreadystatechange = onreadystatechange;
				this.ready = ready;
			}


			Sender.prototype.postData = function() {
				var self = this;
				var xmlhttp = new XMLHttpRequest();
				xmlhttp.onreadystatechange = function() {
					self.onreadystatechange(xmlhttp);
					if (xmlhttp.readyState == 4 && xmlhttp.status == 200) {
						self.ready(xmlhttp);
					};
				};

				xmlhttp.open('GET', self.url, true);
				xmlhttp.send(this.params);
			};
			_go_.Sender = Sender;
		})(window);

		function send() {
			new Sender(document.getElementById('url').value, {
				'id' : document.getElementById('id').value,
				'sh' : document.getElementById('sh').value
			}, function(xmlhttp) {
				document.getElementById('status').innerHTML = JSON.stringify(xmlhttp);
			}, function(xmlhttp) {
				document.getElementById('myDiv').innerHTML = xmlhttp.responseText;
			}).postData();
		}

		send();

	</script>
</body>